<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="//cdn.jsdelivr.net/gh/Hazuki-295/Hazuki-295.github.io@v1.0.4/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="//cdn.jsdelivr.net/gh/Hazuki-295/Hazuki-295.github.io@v1.0.4/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" href="https://hazuki.cn/rss.xml"><link rel="alternate" type="application/atom+xml" href="https://hazuki.cn/atom.xml"><link rel="alternate" type="application/json" href="https://hazuki.cn/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/Hazuki-295/Hazuki-295.github.io@v1.0.4/css/app.css?v=0.2.5"><meta name="keywords" content="计算机网络,应用层"><link rel="canonical" href="https://hazuki.cn/computer-science/computer-network/application-layer/"><title>第 2 章 应用层 - 计算机网络 - 计算机科学 | Hazuki の 小屋 = = 葉月書架</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">第 2 章 应用层</h1><div class="meta"><span class="item" title="创建时间：2021-11-30 23:50:57"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-11-30T23:50:57+08:00">2021-11-30</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>13k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>12 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Hazuki の 小屋</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva4.sinaimg.cn/large/deef1a0cly8gy127iwzngj21hc0u0126.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/deef1a0cly8gy11cqpw4zj21e00u0n6s.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/deef1a0cly8gy0yihkpsej21e00u07at.jpg"></li><li class="item" data-background-image="https://tva1.sinaimg.cn/large/deef1a0cly8gy0yikn1yfj21h50u0tcs.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/deef1a0cly8gy0yhew5ivj21e80u07g2.jpg"></li><li class="item" data-background-image="https://tva2.sinaimg.cn/large/deef1a0cly8gy12epa39jj21he0u0wog.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/" itemprop="item" rel="index" title="分类于 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/computer-network/" itemprop="item" rel="index" title="分类于 计算机网络"><span itemprop="name">计算机网络</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://hazuki.cn/computer-science/computer-network/application-layer/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="//cdn.jsdelivr.net/gh/Hazuki-295/Hazuki-295.github.io@v1.0.4/images/avatar.jpg"><meta itemprop="name" content="Hazuki 叶月"><meta itemprop="description" content="葉月書架, 计算机基础 & 编程笔记"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content=""></span><div class="body md" itemprop="articleBody"><div class="note info"><p>以下为个人学习笔记和习题整理<br>课程：哈尔滨工业大学 计算机网络<br><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMVVwNDExWjdoQz9zaGFyZV9zb3VyY2U9Y29weV93ZWI=">https://www.bilibili.com/video/BV1Up411Z7hC?share_source=copy_web</span></p></div><hr><p><strong class="blue">网络应用</strong>与单机应用的本质不同：</p><div class="note primary"><p>网络应用需要有 <code>网络的基础环境</code> ，一部分软件运行在自己机器上（如浏览器），另一部分软件（或数据信息）运行在互联网的某个地方（如某些服务器），两部分软件需要 <code>进行交互</code> ，才共同构成了网络应用。</p></div><p>既然网络应用是由不同的部分构成的，那么它就存在一个 <code>结构</code> 。</p><h1 id="网络应用的体系结构"><a class="anchor" href="#网络应用的体系结构">#</a> 网络应用的体系结构</h1><p>现代网络应用中，有两种主流的体系结构。</p><h2 id="客户机服务器结构"><a class="anchor" href="#客户机服务器结构">#</a> 客户机 / 服务器结构</h2><p><strong class="red">主从式架构</strong>（英语：<em>Client–server model</em>）也称 <code class="blue">客户端/服务器架构</code> 、 <code class="pink">C/S架构</code> ，是一种网络架构，它把客户端（Client，通常是一个采用图形用户界面的程序），与服务器（Server）区分开来。每一个客户端软件的实例都可以向一个服务器或应用程序服务器发出请求。有很多不同类型的服务器，例如文件服务器、游戏服务器等。</p><ul><li>服务器 (server)<ol><li><code class="aqua">7 * 24小时</code> 提供服务</li><li><code class="red">永久性</code> 访问地址 / 域名</li><li>利用大量服务器实现可扩展性（<span class="pink">数据中心</span>，能够处理大量的并发请求）</li></ol></li><li>客户端 (client)<ol><li>与服务器通信，使用服务器提供的服务</li><li><code class="red">间歇性</code> 接入网络</li><li>可能使用 <code class="aqua">动态IP地址</code></li><li>不会与其他 “客户机” 直接通信</li></ol></li></ul><div class="note primary no-icon"><p>主从式架构通过不同的途径应用于很多不同类型的应用程序，最常见就是目前在因特网上用的 <code>网页</code> 。例如，当你在维基百科阅读文章时，你的电脑和网页浏览器就被当做一个 <code>客户端</code> ，同时，组成维基百科的电脑、数据库和应用程序就被当做 <code>服务器</code> 。当你的网页浏览器向维基百科请求一个指定的文章时，维基百科服务器从维基百科的数据库中找出所有该文章需要的信息，结合成一个网页，再发送回你的浏览器。</p></div><h2 id="点对点结构"><a class="anchor" href="#点对点结构">#</a> 点对点结构</h2><p><strong class="blue">对等式网络</strong>（英语：<em>peer-to-peer</em>， 简称 <code class="aqua">P2P</code> ），又称 <code class="orange">点对点技术</code> ，是无中心服务器、依靠用户群（peers）交换信息的互联网体系，它的作用在于，减低以往网路传输中的节点，以降低资料遗失的风险。与有中心服务器的中央网络系统不同，对等网络的每个用户端既是一个节点，也有服务器的功能，任何一个节点无法直接找到其他节点，必须依靠其户群进行信息交流。</p><ul><li>P2P 架构的特点<ol><li>没有永远在线的服务器</li><li>任意端系统 / 节点之间可以 “直接” 通讯</li><li>节点间歇性接入网络</li><li>节点可能改变 IP 地址</li></ol></li></ul><div class="note info no-icon"><p>P2P 节点能遍布整个互联网，也给包括开发者在内的任何人、组织或政府带来监控难题。P2P 在 <code>网络隐私要求高</code> 和 <code>文件共享</code> 领域中，得到了广泛的应用。使用一般型 P2P 技术的网络系统有比特币、Gnutella 或自由网等。另外，P2P 技术也被使用在类似 VoIP 等实时媒体业务的数据通信中。有些网络（如 <code>Napster</code> 、OpenNAP、IRC @find）使用 <code>客户端-服务器结构</code> 实现包括搜索的一些功能，而使用 <code>P2P结构</code> 来实现另外一些功能。这种网络设计模型不同于客户端 - 服务器模型，在客户端 - 服务器模型中通信通常来往于一个中央服务器。</p></div><h2 id="混合结构hybrid"><a class="anchor" href="#混合结构hybrid">#</a> 混合结构（Hybrid）</h2><p>将两种结构混合在一起使用，利用两者的优点同时规避两者的缺点。如 <code>Napster</code> 。</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_0.png" alt="Untitled" width="700px"></p><h1 id="网络应用进程通信"><a class="anchor" href="#网络应用进程通信">#</a> 网络应用进程通信</h1><h2 id="进程间通信"><a class="anchor" href="#进程间通信">#</a> 进程间通信</h2><p>进程间通信是网络应用的基础，而 <code>进程</code> 是主机上运行的 <code>程序</code> ，</p><ul><li><p>运行在 <code class="blue">同一主机上</code> 的进程之间通过由操作系统提供的 <code class="aqua">进程间通信机制</code> 进行通信；</p></li><li><p>运行在 <code class="red">不同主机上</code> 的进程之间通过 <code class="orange">消息交换（报文交换）</code> 进行通信。<span class="red">（★）</span></p><div class="note danger no-icon"><p>在<span class="red">任一特定的情景</span>下，互相通信的一对进程总是可以被分为</p><ul><li>客户机进程 (<em>client process</em>)： <code class="red">发起通信</code> 的进程；</li><li>服务器进程 (<em>server process</em>)： <code class="aqua">等待通信请求</code> 的进程。</li></ul></div><div class="note success no-icon"><p>采用 <code>P2P架构</code> 的应用也需要通过 “消息交换”，同样存在客户机进程与服务器进程之分。</p></div></li></ul><h2 id="消息交换的实现"><a class="anchor" href="#消息交换的实现">#</a> 消息交换的实现</h2><div class="note primary no-icon"><p>网络应用的信息交换实际上是 <code>进程间的消息交换</code> （通过 socket 套接口），需要实现对 <code>进程的寻址</code> （IP 地址 + 端口号），消息的具体交换遵循的是 <code>应用层协议</code> （如 HTTP、SMTP）。</p></div><ol><li><p>Socket 套接字：进程间通信利用 <code>socket</code> 发送 / 接受信息实现<span class="red">（★）</span>。</p><ol><li><p>可以类比于寄信，socket 套接字接口是 <code class="aqua">“门”</code> ，而硬件基础设施、网络协议栈（传输层及以下）等是 “门外” 的 <code class="orange">传输基础设施</code> ，</p><ul><li>发送方将消息送到门外邮箱</li><li>发送方依赖（门外的）传输基础设施将消息传到接收方所在主机，并送到接收方的门外</li><li>接收方从门外获取消息</li></ul><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_1.png" alt="Untitled"></p></li><li><p><code class="purple">操作系统</code> 向进程提供 API（应用编程接口，即套接字 socket）</p></li><li><p>应用程序员能控制<span class="blue"> socket 应用层端</span> 的所有细节，但对于<span class="orange"> socket 传输层端</span> 只有很少的控制，其支持</p><ul><li><code class="aqua">传输层协议</code> 的选择（TCP 或 UDP）<span class="red">（★）</span></li><li>可能有的几个 <code class="pink">传输层参数</code> 的设置（如最大缓冲区、最大 <code>segment</code> 长度）</li></ul></li></ol></li><li><p>进程寻址：实现不同主机上的进程间通信，每个进程必须拥有 <code class="aqua">标识符</code> 。</p><ul><li>网络层上的 <code>IP地址</code> ，能唯一标识 Internet 上的一台主机；</li><li>操作系统为主机上每个需要通信的进程分配了一个 <code>端口号（Port number）</code> 。</li></ul><p>因此，进程的标识符由 <code>IP 地址 + 端口号</code> 组成，能唯一标识一个 “网络上的进程”。</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_2.png" alt="Untitled"></p><div class="note success no-icon"><p>使用特定知名协议的应用，有其约定的端口号，不能随便使用（其他 0~65536 可用来做自己的网络应用）。</p><ul><li><code>HTTP Server</code> ：80（Web 应用）</li><li><code>Mail Server</code> ：25</li></ul></div></li><li><p>应用层协议：网络应用需遵循应用层协议，完成消息的具体交换。<br>网络应用可根据所使用的协议分为两类，</p><ol><li><code class="aqua">公开协议</code> ：由 <code>RFC(Request For Comments)</code> 定义，公开的标准、规范，允许互操作。如 <code>HTTP</code> , <code>SMTP</code> 等</li><li><code class="pink">私有协议</code> ：多数 P2P 文件共享应用</li></ol><ul><li>应用层协议的内容：（协议三要素）<ul><li>消息的 <code class="aqua">类型（type）</code> ：如请求消息 / 响应消息？</li><li>消息的 <code class="pink">语法（syntax）</code> ：消息中有哪些字段（fields）？每个字段如何描述？</li><li>字段的 <code class="blue">语义（semantics）</code> ：字段中信息的含义。</li><li><code class="orange">规则（rules）</code> ：进程何时发送 / 响应消息，进程如何发送 / 响应消息。</li></ul></li></ul></li></ol><h1 id="传输层所提供的服务"><a class="anchor" href="#传输层所提供的服务">#</a> 传输层所提供的服务</h1><div class="note info no-icon"><p>消息交换不是应用层自己做的， <code>传输层</code> 及之下的各层共同完成传输服务。</p></div><h2 id="网络应用对传输服务的需求"><a class="anchor" href="#网络应用对传输服务的需求">#</a> 网络应用对传输服务的需求</h2><p>传输层可提供的服务大致地可分为三类：</p><ol><li><code class="orange">可靠数据传输(reliable data transfer)</code><ul><li>某些网络应用能够容忍一定的数据丢失。<ul><li>网络电话，网络视频</li></ul></li><li>某些网络应用要求 100% 可靠的数据传输。<ul><li>文件传输，telnet</li></ul></li></ul></li><li><code class="aqua">时间(timing)</code><ul><li>有些应用只有在延迟足够低时才 “有效”。<ul><li>网络电话，网络游戏</li></ul></li></ul></li><li><code class="blue">吞吐量(throughput)</code><ul><li>某些应用只有在带宽达到最低要求时才 “有效”。如网络视频</li><li>某些应用能够适应任何带宽 —— <code>弹性应用（elastic）</code> 。如 email，为异步应用，没有太多时间上的要求。</li></ul></li><li><code class="pink">安全性(security)</code></li></ol><h2 id="internet-提供的传输服务"><a class="anchor" href="#internet-提供的传输服务">#</a> Internet 提供的传输服务</h2><ul><li>TCP 服务<ul><li><code class="red">面向连接</code> ：客户机 / 服务器进程间需要建立连接（全双工）</li><li><code class="blue">可靠传输</code> ：能够把底层的不可靠转变为可靠。</li><li><code class="aqua">流量控制</code> ：发送方不会发送速度过快，超过接收方的处理能力</li><li><code class="orange">拥塞控制</code> ：当网络负载过重时能够限制发送方的发送速度（对整个网络起作用）</li><li>不提供时间 / 延迟保障</li><li>不提供最小带宽保障</li></ul></li><li>UDP 服务<ul><li><code class="red">无连接</code></li><li><code class="blue">不可靠的数据传输</code></li><li>不提供：可靠性保障、流量控制、拥塞控制、延迟保障、带宽保障</li></ul></li></ul><div class="note primary no-icon"><p>UDP 这么多功能都不提供，为什么使用？</p><p>答：UDP 服务做了任何一个传输层服务都要做的基本的事，除此之外不做任何事。它提供了最大的 “自由”，即网络层基本的服务穿透过来了，留给 “应用程序” 发挥的空间，即掌控数据传输的能力。（后面会学到的 <code>QUIC</code> 协议便是基于 UDP 的）</p></div><h1 id="web-应用"><a class="anchor" href="#web-应用">#</a> Web 应用</h1><h2 id="万维网world-wide-web"><a class="anchor" href="#万维网world-wide-web">#</a> 万维网（World Wide Web）</h2><p>最基本的构成要素是 <code class="aqua">网页(Web Page)</code> ，所有的网页之间<span class="pink">互相链接</span>。网页包含多个 <code class="orange">对象(objects)</code> ，其构成为</p><ul><li><code class="orange">对象</code> ：HTML 文件、JPEG 图片、视频文件、动态脚本等，丰富多彩；</li><li><code class="purple">基本HTML文件</code> ：包含对其他对象 <code>引用</code> 的链接，是每个网页都有的。</li></ul><div class="note primary no-icon"><p>对象的寻址通过 <code>URL(Uniform Resoure Locator, 统一资源定位器)</code> 。</p><ul><li><p>基本格式： <code>Scheme://host:port/path</code> ， <code>Scheme</code> 为协议，省略时默认为 <code>http://</code> ，host 为主机 (域名 / IP 地址)，port 为端口号，path 为路径。</p></li><li><p>URL 提供了一种机制，使得万维网上所有的资源都有了 <code>唯一的标识符</code> ，由此它们之间可以互相链接。</p></li></ul></div><h2 id="http-协议"><a class="anchor" href="#http-协议">#</a> HTTP 协议</h2><p>万维网应用所遵循的协议，称为 <code class="blue">超文本传输协议(HyperText Transfer Protocol)</code> 。协议采用的是 <code class="purple">客户机/服务器架构</code> ，其</p><ul><li><span class="blue">客户端</span>： <code class="aqua">浏览器(Browser)</code> ，请求、接收、展示 Web 对象；</li><li><span class="red">服务器</span>： <code class="pink">Web Server</code> ，响应客户的请求，发送对象。</li></ul><h3 id="http-使用的传输层协议tcp"><a class="anchor" href="#http-使用的传输层协议tcp">#</a> HTTP 使用的传输层协议：TCP</h3><p>浏览器 (HTTP 客户端) 与服务器 (HTTP 服务器) 的通信过程：</p><ol><li>服务器在 <code class="red">80 端口</code> 等待客户的请求</li><li><code class="aqua">浏览器发起</code> 到服务器的 TCP 连接</li><li><code class="pink">服务器接受</code> 来自浏览器的 TCP 连接</li><li>浏览器与 Web 服务器<span class="blue">交换 HTTP 消息</span></li><li><span class="red">关闭 TCP 连接</span></li></ol><div class="note info no-icon"><p>HTTP 应用协议是一个 <code>无状态协议</code> ：服务器不维护任何有关客户端过去所发请求的信息。</p><p>有状态的协议更复杂：</p><ul><li>需维护状态（历史信息）；</li><li>如果 client 或 server 失效，会产生状态的不一致，解决这种不一致代价高。</li></ul></div><h3 id="http-连接的两种类型"><a class="anchor" href="#http-连接的两种类型">#</a> HTTP 连接的两种类型</h3><p>对 TCP 的两种使用方法：</p><ul><li><code class="aqua">非持久性连接(Nonpersistent HTTP)</code> ：每个 TCP 连接 <code class="blue">最多允许传输一个对象</code> ，HTTP 1.0 版本使用非持久性连接。</li><li><code class="red">持久性连接(Persistent HTTP)</code> ：每个 TCP 连接 <code class="orange">允许传输多个对象</code> ，HTTP 1.1 版本默认使用持久性连接。</li></ul><h4 id="非持久性连接过程"><a class="anchor" href="#非持久性连接过程">#</a> 非持久性连接过程</h4><p>假定用户在浏览器中输入 URL <code class="pink">http://www.someschool.edu/someDepartment/home.index</code> ， <code class="orange">home.index</code> 包含文本和 <code>10</code> 个 指向 jpeg 图片的链接。</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_3.png" alt="Untitled"></p><h4 id="响应时间分析与建模"><a class="anchor" href="#响应时间分析与建模">#</a> 响应时间分析与建模</h4><p>定义 <code>往返时间 RTT (Round Trip Time)</code> 为从客户端发送一个 <code class="aqua">很小的数据包</code> 到服务器并返回所经历的时间（包括分组的传输时延、排队时延和处理时延）。则从浏览器输入 URL 回车（发送请求）到最后得到文件的 <code class="purple">响应时间 (Response time)</code> 包括：</p><ul><li>发起、建立 <code class="aqua">TCP 连接</code> ：1 个 RTT</li><li><code>发送 HTTP 请求消息</code> 到 HTTP 响应消息的 <code>前几个字节到达</code> ：1 个 RTT</li><li>响应消息中所含的文件 / 对象传输时间</li></ul><p>于是，总的响应时间为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>t</mi><mtext>total</mtext></msub><mo>=</mo><mn>2</mn><mo>×</mo><mi>R</mi><mi>T</mi><mi>T</mi><mo>+</mo><mtext>文件发送时间</mtext></mrow><annotation encoding="application/x-tex">t_{\text {total }}=2 \times R T T+\text { 文件发送时间 }</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.76508em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">total </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.76666em;vertical-align:-.08333em"></span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord text"><span class="mord"> </span><span class="mord cjk_fallback">文件发送时间</span><span class="mord"></span></span></span></span></span></span></p><h3 id="非持久性连接的问题"><a class="anchor" href="#非持久性连接的问题">#</a> 非持久性连接的问题</h3><ul><li><span class="red">每个对象</span>需要 <code>2个RTT</code><ul><li>理论上，该问题总共需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>+</mo><mn>10</mn><mo>×</mo><mn>2</mn><mo>=</mo><mn>22</mn></mrow><annotation encoding="application/x-tex">2 + 10 \times 2 = 22</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">2</span><span class="mord">2</span></span></span></span> 个 RTT</li></ul></li><li><span class="aqua">操作系统</span>需要为每个 TCP 连接 <code class="blue">开销资源</code> （overhead）</li><li>浏览器会打开多个 <code class="orange">并行</code> 的 TCP 连接以获取网页所需对象，但这会给服务器带来巨大的负担。</li></ul><div class="note primary no-icon"><p>TCP 连接是 <code>宝贵的资源</code> ，建立 TCP 连接是有代价的。</p></div><h3 id="持久性连接"><a class="anchor" href="#持久性连接">#</a> 持久性连接</h3><p>发送响应后，服务器<span class="red">保持 TCP 连接</span>的打开，后续的 HTTP 消息可以通过这个连接发送。</p><p>按照是否采用 <code class="blue">流水机制（pipelining）</code> ，持久性连接可分为：</p><ul><li><p><code class="orange">无流水机制</code> 的持久性连接：客户端只有<span class="purple">收到前一个响应后</span>才发送新的请求， <code class="red">每个被引用的对象</code> 耗时 1 个 RTT。</p><ul><li>理论上，该问题总共需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>+</mo><mn>10</mn><mo>×</mo><mn>1</mn><mo>=</mo><mn>12</mn></mrow><annotation encoding="application/x-tex">2 + 10 \times 1 = 12</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mord">2</span></span></span></span> 个 RTT</li></ul></li><li><p><code class="aqua">带有流水机制</code> 的持久性连接：客户端<span class="blue">只要遇到一个引用对象</span>就尽快发出请求，HTTP 1.1 的默认选项。</p><div class="note primary no-icon"><p>理想情况下，收到所有的引用对象只需耗时约 <code>1个RTT</code> 。</p></div><ul><li>理论上，该问题总共需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>+</mo><mn>1</mn><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2 + 1 = 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.72777em;vertical-align:-.08333em"></span><span class="mord">2</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">1</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.64444em;vertical-align:0"></span><span class="mord">3</span></span></span></span> 个 RTT</li></ul></li></ul><h2 id="http-的消息格式"><a class="anchor" href="#http-的消息格式">#</a> HTTP 的消息格式</h2><p>HTTP 协议有两类消息： <code class="aqua">请求消息</code> 和 <code class="pink">响应消息</code> ，均采用 <code>ASCII</code> 码编写，供人类直接阅读。</p><h3 id="请求消息-request"><a class="anchor" href="#请求消息-request">#</a> 请求消息 (request)</h3><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_4.png" alt="Untitled" width="600px"></p><ol><li><p><code class="aqua">Request line</code> 请求行：各版本的 <code>method</code> 方法，</p><ul><li>HTTP/1.0： <code>GET</code> 、 <code>POST</code> 、 <code>HEAD</code></li><li>HTTP/1.1：除上述三种外，增加了 <code>PUT</code> 和 <code>DELETE</code></li></ul><div class="note info no-icon"><ul><li><p><code>HEAD</code> ：请求服务器不要将所请求的对象放入响应消息中；（用作测试）</p></li><li><p><code>PUT</code> ：将消息体中的文件上传到 URL 字段所指定的路径；</p></li><li><p><code>DELETE</code> ：删除 URL 字段所指定的文件。</p></li></ul></div></li><li><p><code class="blue">Header lines</code> 头部行</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_5.png" alt="Untitled" width="600px"></p></li><li><p><code class="red">Entity body</code> 消息体</p><div class="note success no-icon"><p>上传输入的方法：从客户端（cilent）到服务器（server）</p><ul><li>POST 方法：在请求消息的 <code>消息体 (entity body)</code> 中上传客户端的输入。</li><li>URL 方法：使用 GET 方法，输入信息通过 request line 的 <code>URL 字段</code> 上传，适用于信息较少的情况。</li></ul></div></li></ol><h3 id="响应消息-response"><a class="anchor" href="#响应消息-response">#</a> 响应消息 (response)</h3><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_6.png" alt="Untitled" width="600px"></p><ol><li><p><code class="aqua">Status line</code> 状态行： <code>status code</code> 响应状态代码。</p></li><li><p><code class="purple">Header lines</code> 头部行</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_8.png" alt="Untitled" width="600px"></p></li></ol><h2 id="cookie-技术客户端状态信息"><a class="anchor" href="#cookie-技术客户端状态信息">#</a> Cookie 技术：客户端状态信息</h2><p>HTTP 是无状态协议，但很多应用需要服务器掌握客户端的状态（会话状态，如网上购物）。</p><div class="note info no-icon"><p>Cookie 是某些网站为了 <code>辨别用户身份</code> 、进行 <code>session 跟踪</code> ，而存储在用户本地终端上的数据（通常经过加密）。</p></div><ol><li>Cookie 的组件（架设在 HTTP 上）<ol><li><p>HTTP 响应消息的 cookie 头部行</p></li><li><p>HTTP 请求消息的 cookie 头部行</p><div class="note success no-icon"><p>可见，HTTP 消息的头部行是 <code>可扩展的</code> 。</p></div></li><li><p>保存在客户端主机上的 <span class="aqua">cookie 文件</span>，由浏览器管理</p></li><li><p>Web 服务器端的<span class="purple">后台数据库</span></p></li></ol></li><li>Cookie 的原理（通信过程）<br>服务器端将在客户端初次访问时为其创建 cookie ID（存放在后台数据库），并在返回的响应中增加 Set-cookie 头部行。之后客户端的每次请求中，都带有 cookie 的头部行，服务器收到含有 cookie 头部行的请求，将执行 cookie-specific 即用户特定的动作，以根据客户的状态提供相应的信息。cookie 存储在用户本地终端上，所以一段时间后再次和服务器通信时，服务器仍能读取该客户端的状态。</li></ol><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_9.png" alt="Untitled"></p><ol start="3"><li>Cookie 的作用：身份认证，保留购物车、推荐等用户会话状态信息。</li></ol><h2 id="web-缓存代理服务器技术"><a class="anchor" href="#web-缓存代理服务器技术">#</a> Web 缓存 / 代理服务器技术</h2><p>在<span class="red">不访问服务器</span>的前提下满足客户端的 HTTP 请求。</p><div class="note info no-icon"><p>为什么要发明这种技术？（性能角度，而 cookie 是从功能角度）</p><ul><li>缩短客户请求的响应时间</li><li>减少机构 / 组织的流量</li><li>在大范围内（Internet）实现有效的内容分发</li></ul></div><ol><li><p>客户端使用代理服务器的过程：<br><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_10.png" alt="Untitled" width="800px"></p><ul><li>用户设定浏览器通过 <code class="aqua">缓存（代理服务器）</code> 进行 Web 访问</li><li>浏览器向代理服务器发送 <code class="red">所有的HTTP请求</code><ul><li>如果所请求对象在缓存中（称为 <code class="blue">缓存命中</code> ），缓存返回对象</li><li>否则，缓存服务器向 <code class="orange">原始服务器</code> 发送 HTTP 请求，获取对象，然后返回给客户端并<span class="red">保存该对象</span></li></ul></li></ul><div class="note success no-icon"><p>代理服务器（缓存）既充当 <code>客户端</code> ，也充当 <code>服务器</code> 。一般由组织或 ISP（Internet 服务提供商）架设。</p></div></li><li><p>性能分析<br><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_11.png" alt="Untitled"></p><div class="note info no-icon"><p>代理服务器，也是计算机领域中广泛使用的 <code class="auqa">缓存技术</code> （具有普遍性的设计思想）的一种实现。</p></div></li><li><p>解决同步问题（存放在代理服务器的对象副本可能是陈旧的）</p><p>HTTP 协议中的 <code class="aqua">条件GET (conditional GET)</code> 方法：如果缓存有最新的版本，则不需要发送请求对象</p><ul><li><span class="blue">代理服务器</span>：在 HTTP 请求消息中声明 <code class="orange">所持有版本</code> 的日期。<ul><li><code>If-modified-since: &lt;date&gt;</code></li></ul></li><li><span class="purple">原始服务器</span>：如果缓存的版本是最新的，则响应消息中 <code class="red">不包含对象</code> 。<ul><li><code>HTTP/1.0 304 Not Modified</code></li></ul></li></ul></li></ol><h1 id="email-应用"><a class="anchor" href="#email-应用">#</a> Email 应用</h1><h2 id="email-应用的构成组件"><a class="anchor" href="#email-应用的构成组件">#</a> Email 应用的构成组件</h2><ol><li><p><span class="aqua">邮件客户端 (user agent)</span></p><ul><li>读、写 Email 消息（网络应用，也有 <code>Web 形式</code> 的客户端，如 QQ-Mail）</li><li>与服务器交互，收、发 Email 消息</li></ul></li><li><p><span class="blue">邮件服务器 (Mail server)</span></p><ul><li><p><code class="orange">邮箱</code> ：存储发给该用户的 Email</p><p>不在线仍然可以发邮件，存储在邮件服务器</p></li><li><p><code class="purple">消息队列(message queue)</code> ：存储等待发送的 Email</p></li></ul><div class="note info no-icon"><p>采用 Mail Server ，而不是客户端之间直接发送 Email 的原因：</p><ul><li>邮件客户端（手机 / 电脑）不能保证 7 * 24 小时在线</li><li>给别人发送可能失败</li></ul></div><div class="note success no-icon"><p>Email 应用是典型的 <code>“异步” 应用</code> ，即 <code>发送方发送</code> 和 <code>接收方接受</code> 并不需要同时。</p></div></li><li><p><span class="red">SMTP 协议 (Simple Mail Transfer Protocol)</span></p><ul><li><code class="aqua">邮件服务器</code> 之间传递消息所使用的协议<span class="red">（★）</span><ul><li><span class="blue">客户端</span>：发送消息的服务器</li><li><span class="red">服务器</span>：接收消息的服务器</li></ul></li></ul></li></ol><h2 id="smtp-协议"><a class="anchor" href="#smtp-协议">#</a> SMTP 协议</h2><p>使用 <code>TCP</code> 进行 Email 消息的可靠传输（端口 25）</p><ul><li><p>传输过程的三个阶段：<span class="blue">握手</span> → <span class="orange">消息的传输</span> → <span class="aqua">关闭</span></p></li><li><p><span class="red">命令 / 响应</span>交互模式</p><ul><li><p><code class="aqua">命令（command）</code> ：ASCII 文本</p><p>由于历史原因，Email 消息只能包含 7 位 <code>ASCII码</code> 。</p><div class="note success no-icon"><p>Email 是非常古老的应用，在设计之初并没有多媒体，只有文本。</p></div></li><li><p><code class="pink">响应(response)</code> ：状态代码和语句</p></li></ul><p>服务器与客户端交互过程示例：<br><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_12.png" alt="Untitled"></p><ol><li><p>SMTP 协议的特点：</p><ul><li>使用 <code>持久性连接</code> （TCP 协议）</li><li>要求消息必须由 7 位 <code>ASCII 码</code> 构成</li><li>SMTP 服务器利用 <code>CRLF.CRLF</code> 确定消息的结束</li></ul></li><li><p>STMP 与 HTTP 对比：</p><ul><li>都使用 <code class="orange">命令/ 响应</code> 交互模式 ，命令和状态代码都是 ASCII 码</li><li>HTTP 协议： <code class="blue">拉式（pull）</code> ，把网页 “拉” 回本地；每个对象封装在独立的响应消息中。</li><li>SMTP 协议： <code class="aqua">推式（push）</code> ，发出 Email 邮件信息；多个对象在由多个部分构成的消息中发送。</li></ul></li></ol></li></ul><h2 id="email-的消息格式"><a class="anchor" href="#email-的消息格式">#</a> Email 的消息格式</h2><ul><li><p>SMTP 协议：Email 消息的传输 / 交换协议（RFC 822：文本消息格式标准）</p><ul><li><code>头部行(header)</code> ：<span class="blue">To</span>、<span class="orange">From</span>、<span class="aqua">Subject（邮件主题）</span>，与 SMTP 命令不同</li><li><code>消息体(body)</code> ：消息本身，只能是 ASCII 字符</li></ul></li><li><p>MIME 协议：<span class="pink">多媒体邮件扩展</span>（RFC 2045, 2056）</p><ul><li><p>通过在邮件头部 <code class="aqua">增加额外的行</code> 以声明 MIME 的内容类型</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_13.png" alt="Untitled" width="500px"></p></li></ul><div class="note primary no-icon"><p>回顾 MIME 协议以及 cookie 的实现：</p><ul><li>通过在消息的 <code>头部行</code> 中，增加新的行实现对应用的 <code>拓展</code> 。</li><li>计算机领域中， <code>编码解码</code> 应用也在网络中被普遍使用。</li></ul></div></li></ul><h2 id="邮件访问协议从服务器获取邮件"><a class="anchor" href="#邮件访问协议从服务器获取邮件">#</a> 邮件访问协议：从服务器获取邮件</h2><div class="note success no-icon"><p>一个应用可以使用 <code>不止一个协议</code> ：</p><ul><li>邮件客户端向邮件服务器 <code>发送邮件</code> ：使用 SMPT</li><li>邮件客户端从邮件服务器 <code>接收邮件</code> ：使用 “邮件访问协议”。</li></ul></div><ol><li><p>POP 协议（无状态协议）： <code class="aqua">邮局协议（Post Office Protocol）</code> ，是 TCP/IP 协议族中的一员。</p><ul><li><p>主要用于支持使用客户端远程管理在服务器上的电子邮件。（认证 / 授权和下载，<span class="red">认证过程</span> → <span class="blue">事务阶段</span>）</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_14.png" alt="Untitled" width="600px"></p></li><li><p>POP 支持 <code>离线邮件处理</code> ，其具体过程是：邮件发送到服务器上，电子邮件客户端调用邮件客户机程序以连接服务器，并下载所有未阅读的电子邮件。</p><div class="note primary no-icon"><ul><li><p>这种离线访问模式是一种 <code>存储转发</code> 服务，将邮件从邮件服务器端送到个人终端机器上，一般是 PC 机或 Mac。</p><p>一旦邮件下载到 PC 机或 Mac 上，邮件服务器上的邮件将会 <code>被删除</code> 。</p></li><li><p>但目前的 <code>POP3</code> 邮件服务器大都可以 <code>“只下载邮件，服务器端并不删除”</code> ，也就是改进的 POP3 协议。</p><ul><li>“下载并删除” 模式：用户如果换了客户端软件，无法重读该邮件</li><li>“下载并保持” 模式：不同客户端都可以保留消息的拷贝</li></ul></li></ul></div></li><li><p>最新版本为 <code>POP3</code> 。</p></li></ul></li><li><p>IMAP 协议（有状态协议）： <code class="pink">因特网信息访问协议</code> （<em>Internet Mail Access Protocol</em>），是一个应用层协议，用来从 <code class="aqua">本地邮件客户端</code> （如 Microsoft Outlook、Foxmail）访问远程服务器上的邮件。</p><p>相较于 POP3，更多功能、更加复杂、能够操纵服务器上存储的消息。</p><ul><li>所有消息统一保存在一个地方：服务器</li><li>允许用户利用文件夹组织消息</li><li>IMAP 支持跨会话（Session）的用户状态</li></ul></li><li><p>HTTP 协议：浏览器本身也是一种邮件客户端，基于 Web 的 email 应用如 163、QQ Mail 等。</p></li></ol><h1 id="dns-服务"><a class="anchor" href="#dns-服务">#</a> DNS 服务</h1><h2 id="概述"><a class="anchor" href="#概述">#</a> 概述</h2><p><strong class="blue">域名系统</strong>（英语：<em>Domain Name System</em>，缩写： <code>DNS</code> ）是互联网的一项服务，它作为将 <code class="blue">域名</code> 和 <code class="red">IP 地址</code> 相互映射的一个 <code class="aqua">分布式数据库</code> ，能够使人更方便地访问互联网。（IP 地址本身是数字，不易于人类使用，而域名相对来说可读性更好）</p><ul><li>DNS 域名解析系统，是由<span class="pink">多层命名服务器</span>构成的 <code class="red">分布式数据库</code></li><li>DNS 本身也是 <code class="blue">应用层协议</code> ，由应用层上的软件负责完成名字的解析，<ul><li>Internet 的核心功能，用应用层协议实现</li><li>网络边界复杂，分布式而不使用集中式的原因：<br>集中式存在单点失败问题、流量问题、距离问题和维护性问题，不可伸缩，不适合。</li></ul></li><li>DNS 提供的服务：<ul><li><span class="blue">域名</span>向 <span class="red">IP 地址</span>的翻译</li><li><span class="aqua">别名服务</span>：主机别名、邮件服务器别名</li><li><span class="purple">负载均衡</span>：Web 服务器，提供多个映射</li></ul></li></ul><h2 id="分布式层次式数据库"><a class="anchor" href="#分布式层次式数据库">#</a> 分布式层次式数据库</h2><p>客户端想要查询 <code>www.amazon.com</code> 的 IP 地址：</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_15.png" alt="Untitled"></p><ol><li>客户端查询 <code class="aqua">根服务器</code> ，找到 com 域名解析服务器</li><li>客户端查询 <code class="red">com 域名解析服务器</code> ，找到 <span class="exturl" data-url="aHR0cDovL2FtYXpvbi5jb20=">amazon.com</span> 域名解析服务器</li><li>客户端查询 <code class="purple">amazon.com 域名解析服务器</code> ，获得 <span class="exturl" data-url="aHR0cDovL3d3dy5hbWF6b24uY29t">www.amazon.com</span> 的 IP 地址</li></ol><ul><li><p><span class="orange">根域名服务器 (Root DNS servers)</span></p><ul><li><code class="blue">本地域名解析服务器</code> 无法解析域名时，访问 <code class="red">根域名服务器</code> 。</li><li>根域名服务器如果不知道映射，则访问权威域名服务器获得映射，再向本地域名服务器返回映射。</li></ul><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_16.png" alt="Untitled" width="800px"></p></li><li><p><span class="aqua">顶级域名服务器 TLD (<em>Top-Level Domain</em>)</span><br>负责 <code>com</code> 、 <code>org</code> 、 <code>net</code> 、 <code>edu</code> 等顶级域名和 <code>cn, uk, fr</code> 等国家顶级域名</p><ul><li><code>Network Solutions</code> 维护 com 顶级域名服务器</li><li><code>Educause</code> 维护 edu 顶级域名服务器</li></ul></li><li><p><span class="pink">权威 (Authoritative) 域名服务器</span>：组织的域名解析服务器，提供组织内部服务器 (本地化，自治) 的解析服务。</p><ul><li>组织自己负责维护，或委托</li><li>服务提供商负责维护</li></ul></li><li><p><span class="blue">本地域名解析服务器</span>（ <code>不严格属于</code> 层级体系）</p><ul><li>由 ISP 提供，每个 ISP 都有一个本地域名服务器，又称默认域名解析服务器</li><li>当主机进行 DNS 查询时，查询被发送到本地域名服务器，作为代理将查询转发给 (层级式) 域名解析服务器系统，或利用缓存</li></ul></li></ul><h2 id="dns-查询"><a class="anchor" href="#dns-查询">#</a> DNS 查询</h2><p>存在两种查询方式：</p><ol><li><p><span class="blue">迭代查询</span>：被查询服务器返回域名解析服务器的名字</p></li><li><p><span class="red">递归查询</span>：将域名解析的任务交给所联系的服务器</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_18.png" alt="Untitled" height="500px"></p></li></ol><h2 id="dns-记录缓存和更新"><a class="anchor" href="#dns-记录缓存和更新">#</a> DNS 记录缓存和更新</h2><p>只要域名解析服务器获得 <code class="aqua">域名-IP 映射</code> ，即 <code class="red">缓存</code> 这一映射</p><ul><li>一段时间过后，缓存条目失效（删除）</li><li><code class="blue">本地域名服务器</code> 一般会缓存顶级域名服务器的映射，因此根域名服务器 <code class="orange">不经常被访问</code> 。</li></ul><h2 id="dns-记录和消息格式"><a class="anchor" href="#dns-记录和消息格式">#</a> DNS 记录和消息格式</h2><ul><li><p><span class="purple">资源记录 (RR, <em>resource records</em>)</span>： <code class="aqua">RR format: (name, value, type, ttl)</code></p><p>不同的类型对 <code>name</code> 和 <code>value</code> 的解释不同：</p><table><thead><tr><th>Type</th><th>解释</th><th>Name</th><th>Value</th></tr></thead><tbody><tr><td>A</td><td>最基本的主机到 IP 地址的映射</td><td>主机域名</td><td>IP 地址</td></tr><tr><td>NS</td><td>权威域名解析服务器</td><td>域（如 <span class="exturl" data-url="aHR0cDovL2VkdS5jbg==">edu.cn</span>）</td><td>该域权威域名解析服务器的主机域名</td></tr><tr><td>CNAME</td><td>实现别名服务</td><td>某一真实域名的别名</td><td>Value：真实域名</td></tr><tr><td>MX</td><td>邮件服务器</td><td></td><td>与 name 相对应的邮件服务器</td></tr></tbody></table></li><li><p>消息格式</p><ul><li>DNS 协议： <code class="blue">查询/回复</code> 模式，查询（query）和回复（reply）的 <code class="orange">消息格式相同</code></li><li>消息头部<ul><li><p><code>Identification</code> ：16 位查询编号，回复使用相同的编号</p></li><li><p><code>flags</code> ：查询或回复、期望递归、递归可用、权威回答</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_19.png" alt="Untitled" width="600px"></p></li></ul></li></ul></li></ul><h1 id="p2p-应用"><a class="anchor" href="#p2p-应用">#</a> P2P 应用</h1><h2 id="文件分发场景"><a class="anchor" href="#文件分发场景">#</a> 文件分发场景</h2><p><code>C/S 架构</code> v.s. <code>P2P 架构</code> ：从一个服务器向 N 个节点分发一个文件需要多长时间？</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_21.png" alt="Untitled" width="500px"></p><ol><li><p><code class="aqua">C/S 架构</code> ：服务器 <code>串行地</code> 发送 N 个副本</p><ul><li>完成文件分发所需的时间：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi>c</mi><mi>s</mi></mrow></msub><mo>=</mo><mi>max</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><mfrac><mrow><mi>N</mi><mi>F</mi></mrow><msub><mi>u</mi><mi>s</mi></msub></mfrac><mo separator="true">,</mo><mfrac><mi>F</mi><msub><mi>d</mi><mi>min</mi><mo>⁡</mo></msub></mfrac><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">D_{c s}=\max \left\{\frac{N F}{u_{s}}, \frac{F}{d_{\min }}\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.151392em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.80002em;vertical-align:-.65002em"></span><span class="mop">max</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size2">{</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.872331em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285719em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mord mathnormal mtight" style="margin-right:.13889em">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.872331em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3340428571428572em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size2">}</span></span></span></span></span></span></li></ul></li><li><p><code class="pink">P2P 架构</code> ：服务器必须发送一个副本。而<span class="aqua">拥有该文件的一部分</span>的结点可以 <code>共同协助</code> 将文件上传到 Internet 上。</p><ul><li>完成文件分发所需的时间：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mrow><mi mathvariant="normal">P</mi><mn>2</mn><mi mathvariant="normal">P</mi></mrow></msub><mo>=</mo><mi>max</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><mfrac><mi>F</mi><msub><mi>u</mi><mi>s</mi></msub></mfrac><mo separator="true">,</mo><mfrac><mi>F</mi><msub><mi>d</mi><mi>min</mi><mo>⁡</mo></msub></mfrac><mo separator="true">,</mo><mfrac><mrow><mi>N</mi><mi>F</mi></mrow><mrow><msub><mi>u</mi><mi>s</mi></msub><mo>+</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msub><mi>u</mi><mi>i</mi></msub></mrow></mfrac><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">D_{\mathrm{P} 2 \mathrm{P}}=\max \left\{\frac{F}{u_{s}}, \frac{F}{d_{\min }}, \frac{N F}{u_{s}+\sum_{i=1}^{N} u_{i}}\right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.02778em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathrm mtight">P</span></span><span class="mord mtight">2</span><span class="mord mtight"><span class="mord mathrm mtight">P</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:1.804672em;vertical-align:-.654672em"></span><span class="mop">max</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="minner"><span class="mopen delimcenter" style="top:0"><span class="delimsizing size2">{</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.872331em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285719em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.872331em"><span style="top:-2.655em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3340428571428572em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mtight">m</span><span class="mtight">i</span><span class="mtight">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.13889em">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.44509999999999994em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.872331em"><span style="top:-2.570335em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.16454285714285719em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span><span class="mbin mtight">+</span><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-.0000050000000000050004em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.8852357142857143em"><span style="top:-2.1785614285714283em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971428571428572em;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.32143857142857146em"><span></span></span></span></span></span></span><span class="mspace mtight" style="margin-right:.19516666666666668em"></span><span class="mord mtight"><span class="mord mathnormal mtight">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.3280857142857143em"><span style="top:-2.357em;margin-left:0;margin-right:.07142857142857144em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.143em"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:.04em"></span></span><span style="top:-3.394em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.10903em">N</span><span class="mord mathnormal mtight" style="margin-right:.13889em">F</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.654672em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0"><span class="delimsizing size2">}</span></span></span></span></span></span></li></ul><div class="note primary no-icon"><p>随着网络中连接的结点数 N 的增大， <code>C/S 架构</code> 所需的时间线性增长，而 <code>P2P 架构</code> 则越往后越 “平”，存在上界。</p><p>可见， <code>文件分发场景</code> 适合使用 <code>P2P 架构</code> 。</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_22.png" alt="Untitled" width="500px"></p></div></li></ol><h2 id="索引技术"><a class="anchor" href="#索引技术">#</a> 索引技术</h2><p>P2P 系统的索引，即 <code>信息</code> 到 <code>节点位置(IP地址+端口号)</code> 的映射。</p><ul><li><p><code class="blue">集中式索引</code> ：内容和文件传输是分布式的，但是内容定位是高度集中式的（由一台中央目录服务器负责索引）。</p><p>存在的问题：单点失效问题、性能瓶颈、版权问题</p></li><li><p><code class="orange">洪泛式查询（Query flooding）</code> ：完全分布式架构，每个节点对它共享的文件进行索引，且只对它共享的文件进行索引。</p><ul><li><p>覆盖网络 (overlay network): Graph</p><ol><li>节点 X 与 Y 之间如果有 TCP 连接，那么构成一个边（虚拟链路）</li><li>所有的活动节点和边构成覆盖网络。</li></ol><p>查询消息通过已有的 TCP 连接发送，节点转发查询消息。</p><p>如果查询命中，则利用反向路径发回查询节点，最后请求查询的主机和命中主机建立 TCP 连接。</p><div class="note info no-icon"><p>像洪水一般在网络中 “泛滥”，会给网络带来负担。</p></div></li></ul></li><li><p><code class="red">层次式覆盖网络</code> ：介于集中式索引和洪泛查询之间的方法</p><ul><li>每个节点或者是一个 <code class="blue">超级节点</code> ，或者被分配一个超级节点（普通结点），超级节点负责跟踪子节点的内容（提供索引）<ol><li>节点和超级节点间维持 TCP 连接（分层式）</li><li>某些超级节点对之间维持 TCP 连接（洪泛式、分布式）</li></ol></li></ul></li></ul><div class="note success no-icon"><p>P2P 网络应用的通信过程的实质：C/S 进程之间的通信。</p><ul><li>P2P 应用程序结构：部分实现 server/cilent 功能：多线程，多进程等</li><li>P2P 网络应用是否适合基于 DNS 实现 peer 寻址？<br>不适合。动态 IP 地址影响时刻更新 DNS，需要 DNS 处理能力很强。</li></ul></div><h1 id="socket-编程"><a class="anchor" href="#socket-编程">#</a> socket 编程</h1><p>socket 是一种 <code class="purple">操作系统</code> 提供的 <code class="aqua">进程间通信机制</code></p><p>在操作系统中，通常会为 <code class="blue">应用程序</code> 提供一组 <code class="red">应用程序接口（API）</code> ，称为套接字接口（英语：socket API）。</p><ul><li>最初设计：socket API 来源于 Unix-Berkley 的项目，是面向 TCP/IP 协议栈的接口（当前可以面向多个协议栈）。</li><li>目前：事实上的工业标准，绝大多数 OS 均支持，是 Internet 网络应用最典型的 API 接口。</li><li>通信模型：客户机 / 服务器模型（C/S），是应用进程间通信的抽象机制。<div class="note success no-icon"><p>socket 一词的来历：就像一个 <code>“插座”</code> ，两者之间一插就可以通信。</p></div></li></ul><h2 id="应用编程接口-api"><a class="anchor" href="#应用编程接口-api">#</a> 应用编程接口 API</h2><p><span class="blue">应用进程</span>的控制权和<span class="pink">操作系统</span>的控制权进行转换的一个 <code class="aqua">系统调用</code> 接口。</p><ul><li><p>应用进程将 <code class="red">控制权</code> 交给操作系统（系统调用），操作系统执行相应的过程，并将结果返回给应用进程。</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_25.png" alt="Untitled"></p></li></ul><h2 id="三种典型的-api"><a class="anchor" href="#三种典型的-api">#</a> 三种典型的 API</h2><ul><li><p>Berkeley <code>UNIX 操作系统</code> 定义的一种 API，称为套接字接口（socket interface），简称套接字（socket）。</p><div class="note primary"><p>最具有代表性，应用最广泛的标准的伯克利套接字。</p></div></li><li><p>微软在 socket 的基础上扩展形成的一个稍有不同的 API，称为 <code>WINSOCK</code> （Windows Socket Interface）。</p><div class="note success"><p><code class="orange">Unix / Linux</code> 使用的是标准的伯克利套接字，而 <code class="blue">windows</code> 使用的是 <code class="purple">WINSOCK</code> ，两者之间有很大部分重叠。</p></div></li><li><p><code>AT&amp;T</code> 为其 <code>UNIX V</code> 定义了一种 API，简写为 <code>TLI</code> （Transport Layer Interface）传输层接口。</p></li></ul><h2 id="应用进程通信的寻址问题"><a class="anchor" href="#应用进程通信的寻址问题">#</a> 应用进程通信的寻址问题</h2><ul><li><span class="blue">标识通信端点</span>（对外）<ul><li><code class="orange">IP 地址 + 端口号</code> （又称 “端点地址”）</li></ul></li><li><span class="red">操作系统</span>如何管理套接字（对内）<ul><li><span class="aqua">套接字描述符 (socket descriptor)</span>：小整数</li><li><span class="pink">socket 抽象</span>：当应用进程 <code class="blue">创建套接字</code> 时，操作系统分配一个 <code class="red">数据结构</code> 存储该套接字相关信息，并返回套接字描述符</li></ul></li></ul><h2 id="socket-api-函数"><a class="anchor" href="#socket-api-函数">#</a> socket API 函数</h2><table><thead><tr><th>函数名</th><th>函数功能</th><th>适用条件</th></tr></thead><tbody><tr><td><code class="grey">WSAStartup()</code></td><td>初始化 socket 库</td><td>仅对 WinSock</td></tr><tr><td><code class="grey">WSACleanup()</code></td><td>清除 / 终止 socket 库的使用</td><td>仅对 WinSock</td></tr><tr><td><code class="purple">socket()</code></td><td>创建套接字</td></tr><tr><td><code class="purple">closesocket()</code></td><td>释放 / 关闭套接字</td><td>在 Unix / Linux 中为 <code class="orange">close()</code> ，与关闭文件相同</td></tr><tr><td><code class="red">bind()</code></td><td>绑定套接字的<span class="red">本地 IP 地址和端口号</span></td><td>通常<span class="blue">客户端不需要</span>，由<span class="purple">操作系统</span>自动完成</td></tr><tr><td><code class="blue">listen()</code></td><td>置服务器端 TCP 套接字为<span class="aqua">监听模式</span>，并<span class="orange">设置队列大小</span></td><td>仅用于<span class="red">服务器端 TCP 套接字</span></td></tr><tr><td><code class="orange">connect()</code></td><td><span class="purple">“连接” 远端服务器</span>（UDP 实际上没有连接）</td><td>仅用于<span class="aqua">客户端</span></td></tr><tr><td><code class="orange">accept()</code></td><td>接受 / 提取一个 <span class="blue">TCP 连接请求</span>，创建<span class="red">新套接字</span>，通过新套接字通信</td><td>仅用于<span class="red">服务器端 TCP 套接字</span></td></tr><tr><td><code class="green">send()</code></td><td>发送数据</td><td>用于<span class="aqua"> TCP 套接字</span> 或 连接模式的<span class="purple">客户端 UDP 套接字</span></td></tr><tr><td><code class="green">sendto()</code></td><td>发送数据报</td><td>用于<span class="blue">非连接模式的 UDP 套接字</span></td></tr><tr><td><code class="pink">recv()</code></td><td>接收数据</td><td>用于<span class="aqua"> TCP 套接字</span> 或 连接模式的<span class="purple">客户端 UDP 套接字</span></td></tr><tr><td><code class="pink">recvfrom()</code></td><td>接收数据报</td><td>用于<span class="blue">非连接模式的 UDP 套接字</span></td></tr><tr><td><code class="grey">setsockopt()</code></td><td>设置套接字选项参数</td></tr><tr><td><code class="grey">getsockopt()</code></td><td>获取套接字选项参数</td></tr></tbody></table><h2 id="socket-编程示例"><a class="anchor" href="#socket-编程示例">#</a> socket 编程示例</h2><div class="note info no-icon"><p>We’ll use the following simple <code>client-server application</code> to demonstrate socket programming for both <code>UDP</code> and <code>TCP</code> :</p><ol><li>The client reads a line of characters (data) from its keyboard and sends the data to the server.</li><li>The server receives the data and converts the characters to uppercase.</li><li>The server sends the modified data to the client.</li><li>The client receives the modified data and displays the line on its screen.</li></ol></div><h3 id="socket-programming-with-udp"><a class="anchor" href="#socket-programming-with-udp">#</a> Socket Programming with UDP</h3><ol><li><p>The client-server application using <code>UDP</code> :</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_26.png" alt="Untitled" width="600px"></p><div class="tab" data-id="id1" data-title="UDPClient.py"><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># UDPClient.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> socket <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>serverName <span class="token operator">=</span> <span class="token string">'hostname'</span></pre></td></tr><tr><td data-num="5"></td><td><pre>serverPort <span class="token operator">=</span> <span class="token number">12000</span></pre></td></tr><tr><td data-num="6"></td><td><pre>clientSocket <span class="token operator">=</span> socket<span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_DGRAM<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>message <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Input lowercase sentence:'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>clientSocket<span class="token punctuation">.</span>sendto<span class="token punctuation">(</span>message<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>serverName<span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>modifiedMessage<span class="token punctuation">,</span> serverAddress <span class="token operator">=</span> clientSocket<span class="token punctuation">.</span>recvfrom<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>modifiedMessage<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>clientSocket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure></div><div class="tab" data-id="id1" data-title="UDPServer.py"><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># UDPServer.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> socket <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>serverPort <span class="token operator">=</span> <span class="token number">12000</span></pre></td></tr><tr><td data-num="5"></td><td><pre>serverSocket <span class="token operator">=</span> socket<span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_DGRAM<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>serverSocket<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The server is ready to receive"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    message<span class="token punctuation">,</span> clientAddress <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span>recvfrom<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    modifiedMessage <span class="token operator">=</span> message<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    serverSocket<span class="token punctuation">.</span>sendto<span class="token punctuation">(</span>modifiedMessage<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> clientAddress<span class="token punctuation">)</span></pre></td></tr></table></figure></div></li></ol><h3 id="socket-programming-with-tcp"><a class="anchor" href="#socket-programming-with-tcp">#</a> Socket Programming with TCP</h3><ol><li><p>TCP Server <code>欢迎套接字(welcome socket)</code> 与 <code>连接套接字(connection socket)</code> ：</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_27.png" alt="Untitled" width="500px"></p></li><li><p>The client-server application using <code>TCP</code> :</p><p><img data-src="/assets/computer-science/computer-network/application-layer/Untitled_28.png" alt="Untitled" width="600px"></p><div class="tab" data-id="id2" data-title="TCPClient.py"><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># TCPClient.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> socket <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>serverName <span class="token operator">=</span> <span class="token string">'servername'</span></pre></td></tr><tr><td data-num="5"></td><td><pre>serverPort <span class="token operator">=</span> <span class="token number">12000</span></pre></td></tr><tr><td data-num="6"></td><td><pre>clientSocket <span class="token operator">=</span> socket<span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span> SOCK_STREAM<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>clientSocket<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>serverName<span class="token punctuation">,</span>serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>sentence <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Input lowercase sentence:'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>clientSocket<span class="token punctuation">.</span>send<span class="token punctuation">(</span>sentence<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>modifiedSentence <span class="token operator">=</span> clientSocket<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'From Server: '</span><span class="token punctuation">,</span> modifiedSentence<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>clientSocket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure></div><div class="tab" data-id="id2" data-title="TCPServer.py"><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># TCPServer.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> socket <span class="token keyword">import</span> <span class="token operator">*</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>serverPort <span class="token operator">=</span> <span class="token number">12000</span></pre></td></tr><tr><td data-num="5"></td><td><pre>serverSocket <span class="token operator">=</span> socket<span class="token punctuation">(</span>AF_INET<span class="token punctuation">,</span>SOCK_STREAM<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>serverSocket<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span>serverPort<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>serverSocket<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'The server is ready to receive'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    connectionSocket<span class="token punctuation">,</span> addr <span class="token operator">=</span> serverSocket<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    sentence <span class="token operator">=</span> connectionSocket<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    capitalizedSentence <span class="token operator">=</span> sentence<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    connectionSocket<span class="token punctuation">.</span>send<span class="token punctuation">(</span>capitalizedSentence<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    connectionSocket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure></div></li></ol><div class="tags"><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" rel="tag"><i class="ic i-tag"></i> 计算机网络</a> <a href="/tags/%E5%BA%94%E7%94%A8%E5%B1%82/" rel="tag"><i class="ic i-tag"></i> 应用层</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-12-07 00:38:05" itemprop="dateModified" datetime="2021-12-07T00:38:05+08:00">2021-12-07</time> </span><span id="computer-science/computer-network/application-layer/" class="item leancloud_visitors" data-flag-title="第 2 章 应用层" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="//cdn.jsdelivr.net/gh/Hazuki-295/Hazuki-295.github.io@v1.0.4/images/wechatpay.jpg" alt="Hazuki 叶月 微信支付"><p>微信支付</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Hazuki 叶月 <i class="ic i-at"><em>@</em></i></li><li class="link"><strong>本文链接：</strong> <a href="https://hazuki.cn/computer-science/computer-network/application-layer/" title="第 2 章 应用层">https://hazuki.cn/computer-science/computer-network/application-layer/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/hexo/Theme.Shoka/01_Shoka/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;wx4.sinaimg.cn&#x2F;large&#x2F;deef1a0cly8gwx6hzgy0sj21990u0dqf.jpg" title="Shoka主题：修改切换标签时更换标题"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Shoka 主题</span><h3>Shoka主题：修改切换标签时更换标题</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%9A%84%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">网络应用的体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E6%9C%BA%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%93%E6%9E%84"><span class="toc-number">1.1.</span> <span class="toc-text">客户机 &#x2F; 服务器结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%82%B9%E5%AF%B9%E7%82%B9%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.</span> <span class="toc-text">点对点结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E7%BB%93%E6%9E%84hybrid"><span class="toc-number">1.3.</span> <span class="toc-text">混合结构（Hybrid）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1"><span class="toc-number">2.</span> <span class="toc-text">网络应用进程通信</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="toc-number">2.1.</span> <span class="toc-text">进程间通信</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B6%88%E6%81%AF%E4%BA%A4%E6%8D%A2%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.2.</span> <span class="toc-text">消息交换的实现</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%E6%89%80%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.</span> <span class="toc-text">传输层所提供的服务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E5%AF%B9%E4%BC%A0%E8%BE%93%E6%9C%8D%E5%8A%A1%E7%9A%84%E9%9C%80%E6%B1%82"><span class="toc-number">3.1.</span> <span class="toc-text">网络应用对传输服务的需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#internet-%E6%8F%90%E4%BE%9B%E7%9A%84%E4%BC%A0%E8%BE%93%E6%9C%8D%E5%8A%A1"><span class="toc-number">3.2.</span> <span class="toc-text">Internet 提供的传输服务</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web-%E5%BA%94%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">Web 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%87%E7%BB%B4%E7%BD%91world-wide-web"><span class="toc-number">4.1.</span> <span class="toc-text">万维网（World Wide Web）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#http-%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.2.</span> <span class="toc-text">HTTP 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#http-%E4%BD%BF%E7%94%A8%E7%9A%84%E4%BC%A0%E8%BE%93%E5%B1%82%E5%8D%8F%E8%AE%AEtcp"><span class="toc-number">4.2.1.</span> <span class="toc-text">HTTP 使用的传输层协议：TCP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#http-%E8%BF%9E%E6%8E%A5%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.2.2.</span> <span class="toc-text">HTTP 连接的两种类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E6%8C%81%E4%B9%85%E6%80%A7%E8%BF%9E%E6%8E%A5%E8%BF%87%E7%A8%8B"><span class="toc-number">4.2.2.1.</span> <span class="toc-text">非持久性连接过程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4%E5%88%86%E6%9E%90%E4%B8%8E%E5%BB%BA%E6%A8%A1"><span class="toc-number">4.2.2.2.</span> <span class="toc-text">响应时间分析与建模</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E6%8C%81%E4%B9%85%E6%80%A7%E8%BF%9E%E6%8E%A5%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">4.2.3.</span> <span class="toc-text">非持久性连接的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%81%E4%B9%85%E6%80%A7%E8%BF%9E%E6%8E%A5"><span class="toc-number">4.2.4.</span> <span class="toc-text">持久性连接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#http-%E7%9A%84%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.3.</span> <span class="toc-text">HTTP 的消息格式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E6%B6%88%E6%81%AF-request"><span class="toc-number">4.3.1.</span> <span class="toc-text">请求消息 (request)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E6%B6%88%E6%81%AF-response"><span class="toc-number">4.3.2.</span> <span class="toc-text">响应消息 (response)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cookie-%E6%8A%80%E6%9C%AF%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%8A%B6%E6%80%81%E4%BF%A1%E6%81%AF"><span class="toc-number">4.4.</span> <span class="toc-text">Cookie 技术：客户端状态信息</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E7%BC%93%E5%AD%98%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8A%80%E6%9C%AF"><span class="toc-number">4.5.</span> <span class="toc-text">Web 缓存 &#x2F; 代理服务器技术</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#email-%E5%BA%94%E7%94%A8"><span class="toc-number">5.</span> <span class="toc-text">Email 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#email-%E5%BA%94%E7%94%A8%E7%9A%84%E6%9E%84%E6%88%90%E7%BB%84%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">Email 应用的构成组件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#smtp-%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.2.</span> <span class="toc-text">SMTP 协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#email-%E7%9A%84%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="toc-number">5.3.</span> <span class="toc-text">Email 的消息格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%82%AE%E4%BB%B6%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%8E%B7%E5%8F%96%E9%82%AE%E4%BB%B6"><span class="toc-number">5.4.</span> <span class="toc-text">邮件访问协议：从服务器获取邮件</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dns-%E6%9C%8D%E5%8A%A1"><span class="toc-number">6.</span> <span class="toc-text">DNS 服务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-number">6.1.</span> <span class="toc-text">概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E5%B1%82%E6%AC%A1%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">6.2.</span> <span class="toc-text">分布式层次式数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dns-%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.3.</span> <span class="toc-text">DNS 查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dns-%E8%AE%B0%E5%BD%95%E7%BC%93%E5%AD%98%E5%92%8C%E6%9B%B4%E6%96%B0"><span class="toc-number">6.4.</span> <span class="toc-text">DNS 记录缓存和更新</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dns-%E8%AE%B0%E5%BD%95%E5%92%8C%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F"><span class="toc-number">6.5.</span> <span class="toc-text">DNS 记录和消息格式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#p2p-%E5%BA%94%E7%94%A8"><span class="toc-number">7.</span> <span class="toc-text">P2P 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%88%86%E5%8F%91%E5%9C%BA%E6%99%AF"><span class="toc-number">7.1.</span> <span class="toc-text">文件分发场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E6%8A%80%E6%9C%AF"><span class="toc-number">7.2.</span> <span class="toc-text">索引技术</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#socket-%E7%BC%96%E7%A8%8B"><span class="toc-number">8.</span> <span class="toc-text">socket 编程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%BC%96%E7%A8%8B%E6%8E%A5%E5%8F%A3-api"><span class="toc-number">8.1.</span> <span class="toc-text">应用编程接口 API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E5%85%B8%E5%9E%8B%E7%9A%84-api"><span class="toc-number">8.2.</span> <span class="toc-text">三种典型的 API</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1%E7%9A%84%E5%AF%BB%E5%9D%80%E9%97%AE%E9%A2%98"><span class="toc-number">8.3.</span> <span class="toc-text">应用进程通信的寻址问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#socket-api-%E5%87%BD%E6%95%B0"><span class="toc-number">8.4.</span> <span class="toc-text">socket API 函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#socket-%E7%BC%96%E7%A8%8B%E7%A4%BA%E4%BE%8B"><span class="toc-number">8.5.</span> <span class="toc-text">socket 编程示例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#socket-programming-with-udp"><span class="toc-number">8.5.1.</span> <span class="toc-text">Socket Programming with UDP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#socket-programming-with-tcp"><span class="toc-number">8.5.2.</span> <span class="toc-text">Socket Programming with TCP</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/computer-science/computer-network/application-layer/" rel="bookmark" title="第2章 应用层">第2章 应用层</a></li><li><a href="/computer-science/computer-network/transport-layer/" rel="bookmark" title="第3章 传输层">第3章 传输层</a></li><li><a href="/computer-science/computer-network/network-layer-1/" rel="bookmark" title="第4章 网络层：数据平面">第4章 网络层：数据平面</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Hazuki 叶月" data-src="//cdn.jsdelivr.net/gh/Hazuki-295/Hazuki-295.github.io@v1.0.4/images/avatar.jpg"><p class="name" itemprop="name">Hazuki 叶月</p><div class="description" itemprop="description">计算机基础 & 编程笔记</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">11</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">8</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">9</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0hhenVraS0yOTU=" title="https:&#x2F;&#x2F;github.com&#x2F;Hazuki-295"><i class="ic i-github"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9sdW8tc2hlbmctNzYtMjItMzg=" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;luo-sheng-76-22-38"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly95Lm11c2ljLjE2My5jb20vbS91c2VyP2lkPTMwOTUzOTk5NA==" title="https:&#x2F;&#x2F;y.music.163.com&#x2F;m&#x2F;user?id&#x3D;309539994"><i class="ic i-cloud-music"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-magic"></i>链环</a><ul class="submenu"><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友達</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/computer-network/" title="分类于 计算机网络">计算机网络</a></div><span><a href="/computer-science/computer-network/network-layer-1/" title="第4章 网络层：数据平面">第4章 网络层：数据平面</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/" title="分类于 机器学习">机器学习</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/Scikit-learn-Cookbook/" title="分类于 Scikit-learn Cookbook">Scikit-learn Cookbook</a></div><span><a href="/computer-science/machine-learing/Scikit-learn-Cookbook/%E7%AC%AC2%E7%AB%A0%20%E5%A4%84%E7%90%86%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B/" title="第2章 处理线性模型">第2章 处理线性模型</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/computer-network/" title="分类于 计算机网络">计算机网络</a></div><span><a href="/computer-science/computer-network/transport-layer/" title="第3章 传输层">第3章 传输层</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/" title="分类于 机器学习">机器学习</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/Scikit-learn-Cookbook/" title="分类于 Scikit-learn Cookbook">Scikit-learn Cookbook</a></div><span><a href="/computer-science/machine-learing/Scikit-learn-Cookbook/%E7%AC%AC4%E7%AB%A0%20%E4%BD%BF%E7%94%A8%20scikit-learn%20%E5%AF%B9%E6%95%B0%E6%8D%AE%E5%88%86%E7%B1%BB/" title="第4章 使用 scikit-learn 对数据分类">第4章 使用 scikit-learn 对数据分类</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/" title="分类于 机器学习">机器学习</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/Scikit-learn-Cookbook/" title="分类于 Scikit-learn Cookbook">Scikit-learn Cookbook</a></div><span><a href="/computer-science/machine-learing/Scikit-learn-Cookbook/%E7%AC%AC3%E7%AB%A0%20%E4%BD%BF%E7%94%A8%E8%B7%9D%E7%A6%BB%E5%90%91%E9%87%8F%E6%9E%84%E5%BB%BA%E6%A8%A1%E5%9E%8B/" title="第3章 使用距离向量构建模型">第3章 使用距离向量构建模型</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/" title="分类于 机器学习">机器学习</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/Scikit-learn-Cookbook/" title="分类于 Scikit-learn Cookbook">Scikit-learn Cookbook</a></div><span><a href="/computer-science/machine-learing/Scikit-learn-Cookbook/%E7%AC%AC5%E7%AB%A0%20%E6%A8%A1%E5%9E%8B%E5%90%8E%E5%A4%84%E7%90%86/" title="第5章 模型后处理">第5章 模型后处理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/" title="分类于 机器学习">机器学习</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/machine-learing/Scikit-learn-Cookbook/" title="分类于 Scikit-learn Cookbook">Scikit-learn Cookbook</a></div><span><a href="/computer-science/machine-learing/Scikit-learn-Cookbook/%E7%AC%AC1%E7%AB%A0%20%E6%A8%A1%E5%9E%8B%E9%A2%84%E5%A4%84%E7%90%86/" title="第1章 模型预处理">第1章 模型预处理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/hexo/" title="分类于 Hexo 博客搭建">Hexo 博客搭建</a> <i class="ic i-angle-right"></i> <a href="/categories/hexo/Theme-Shoka/" title="分类于 Shoka 主题">Shoka 主题</a></div><span><a href="/hexo/Theme.Shoka/01_Shoka/" title="Shoka主题：修改切换标签时更换标题">Shoka主题：修改切换标签时更换标题</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/computer-network/" title="分类于 计算机网络">计算机网络</a></div><span><a href="/computer-science/computer-network/application-layer/" title="第2章 应用层">第2章 应用层</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/computer-organization/" title="分类于 计算机组成原理">计算机组成原理</a></div><span><a href="/computer-science/computer-organization/Chapter1-Computer-Abstractions-and-Technology/" title="Chapter 1 Computer Abstractions and Technology">Chapter 1 Computer Abstractions and Technology</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Hazuki 叶月 @ Hazuki の 小屋</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">174k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">2:38</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"computer-science/computer-network/application-layer/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="//cdn.jsdelivr.net/gh/Hazuki-295/Hazuki-295.github.io@v1.0.4/js/app.js?v=0.2.5"></script></body></html>